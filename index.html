<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ Supabase</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #3f51b5;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        h2 {
            color: #666;
            margin: 25px 0 15px 0;
        }
        
        .config-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #3f51b5;
        }
        
        .config-item {
            margin-bottom: 10px;
            font-family: monospace;
            word-break: break-all;
            padding: 8px;
            background: white;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        .test-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .test-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .test-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .test-card.success {
            border-color: #4caf50;
            background-color: #f1f8e9;
        }
        
        .test-card.error {
            border-color: #f44336;
            background-color: #ffebee;
        }
        
        .test-card.warning {
            border-color: #ff9800;
            background-color: #fff3e0;
        }
        
        .test-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .test-result {
            padding: 10px;
            border-radius: 4px;
            background: #f5f5f5;
            font-family: monospace;
            font-size: 14px;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-online {
            background-color: #4caf50;
        }
        
        .status-offline {
            background-color: #f44336;
        }
        
        .status-warning {
            background-color: #ff9800;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            background: #3f51b5;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: #303f9f;
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .logs-section {
            margin-top: 30px;
        }
        
        .logs-container {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #1e1e1e;
            color: #f5f5f5;
            font-family: monospace;
            font-size: 14px;
        }
        
        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid #333;
        }
        
        .log-timestamp {
            color: #888;
            margin-right: 10px;
        }
        
        .log-level-info {
            color: #4fc3f7;
        }
        
        .log-level-success {
            color: #4caf50;
        }
        
        .log-level-error {
            color: #f44336;
        }
        
        .log-level-warning {
            color: #ff9800;
        }
        
        .summary {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #4caf50;
        }
        
        .summary.error {
            background: #ffebee;
            border-left-color: #f44336;
        }
        
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3f51b5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Supabase</h1>
        
        <div class="config-section">
            <h2>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</h2>
            <div class="config-item">
                <strong>URL:</strong> https://chgbdbuiqzdmwiniyxrk.supabase.co
            </div>
            <div class="config-item">
                <strong>Publishable Key:</strong> sb_publishable_9NXa4FwnnrICXnXmrOVqRg_KB5LHkmk
            </div>
            <div class="config-item">
                <strong>Anon Key:</strong> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
            </div>
        </div>
        
        <div class="controls">
            <button id="runAllTests">
                <span class="loader hidden"></span>
                <span>–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</span>
            </button>
            <button id="clearLogs">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
            <button id="exportLogs">–≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤</button>
        </div>
        
        <div id="summary" class="summary"></div>
        
        <h2>–¢–µ—Å—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h2>
        <div class="test-section">
            <div class="test-card" id="test1">
                <div class="test-title">
                    <span class="status-indicator"></span>
                    –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ URL
                </div>
                <p>–ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É URL</p>
                <div class="test-result">–û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...</div>
            </div>
            
            <div class="test-card" id="test2">
                <div class="test-title">
                    <span class="status-indicator"></span>
                    –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ REST API
                </div>
                <p>GET –∑–∞–ø—Ä–æ—Å –∫ REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—É</p>
                <div class="test-result">–û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...</div>
            </div>
            
            <div class="test-card" id="test3">
                <div class="test-title">
                    <span class="status-indicator"></span>
                    –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
                </div>
                <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ auth</p>
                <div class="test-result">–û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...</div>
            </div>
            
            <div class="test-card" id="test4">
                <div class="test-title">
                    <span class="status-indicator"></span>
                    –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ Realtime
                </div>
                <p>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Realtime WebSocket</p>
                <div class="test-result">–û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...</div>
            </div>
            
            <div class="test-card" id="test5">
                <div class="test-title">
                    <span class="status-indicator"></span>
                    –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ Storage
                </div>
                <p>–î–æ—Å—Ç—É–ø –∫ Storage API</p>
                <div class="test-result">–û–∂–∏–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...</div>
            </div>
        </div>
        
        <div class="logs-section">
            <h2>–õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h2>
            <div id="logsContainer" class="logs-container">
                <div class="log-entry">
                    <span class="log-timestamp" id="current-time"></span>
                    <span class="log-level-info">–°–∏—Å—Ç–µ–º–∞</span>: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–Ω–µ–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const config = {
            supabaseUrl: 'https://chgbdbuiqzdmwiniyxrk.supabase.co',
            publishableKey: 'sb_publishable_9NXa4FwnnrICXnXmrOVqRg_KB5LHkmk',
            anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNoZ2JkYnVpcXpkbXdpbml5eHJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5NzY5MzUsImV4cCI6MjA4NDU1MjkzNX0.KvpKM7FggBOWNuFR8gmL7cjk64tt6CCgAI-UlkP7ZXU'
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const elements = {
            runAllTests: document.getElementById('runAllTests'),
            clearLogs: document.getElementById('clearLogs'),
            exportLogs: document.getElementById('exportLogs'),
            logsContainer: document.getElementById('logsContainer'),
            summary: document.getElementById('summary'),
            currentTime: document.getElementById('current-time')
        };

        // –õ–æ–≥–∏
        let logs = [];
        let testResults = {
            passed: 0,
            failed: 0,
            total: 5
        };

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function updateTime() {
            const now = new Date();
            elements.currentTime.textContent = now.toLocaleTimeString();
        }
        setInterval(updateTime, 1000);
        updateTime();

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        function log(level, message, details = null) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = {
                timestamp,
                level,
                message,
                details
            };
            
            logs.push(logEntry);
            
            const logElement = document.createElement('div');
            logElement.className = 'log-entry';
            logElement.innerHTML = `
                <span class="log-timestamp">${timestamp}</span>
                <span class="log-level-${level}">${level.toUpperCase()}</span>: ${message}
                ${details ? `<pre style="margin-top: 5px; color: #aaa;">${JSON.stringify(details, null, 2)}</pre>` : ''}
            `;
            
            elements.logsContainer.appendChild(logElement);
            elements.logsContainer.scrollTop = elements.logsContainer.scrollHeight;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ—Å—Ç–∞
        function updateTestCard(testId, status, result) {
            const card = document.getElementById(testId);
            const indicator = card.querySelector('.status-indicator');
            const resultDiv = card.querySelector('.test-result');
            
            card.className = 'test-card ' + status;
            indicator.className = 'status-indicator ' + {
                'success': 'status-online',
                'error': 'status-offline',
                'warning': 'status-warning'
            }[status];
            
            resultDiv.textContent = typeof result === 'string' ? result : JSON.stringify(result, null, 2);
        }

        // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ URL
        async function testBaseUrl() {
            log('info', '–ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–∞ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ URL');
            updateTestCard('test1', 'warning', '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');
            
            try {
                const startTime = Date.now();
                const response = await fetch(config.supabaseUrl, {
                    method: 'GET',
                    mode: 'no-cors'
                });
                const endTime = Date.now();
                const latency = endTime - startTime;
                
                updateTestCard('test1', 'success', `‚úÖ URL –¥–æ—Å—Ç—É–ø–µ–Ω\n‚è±Ô∏è –ó–∞–¥–µ—Ä–∂–∫–∞: ${latency}–º—Å`);
                log('success', `–ë–∞–∑–æ–≤—ã–π URL –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–¥–µ—Ä–∂–∫–∞: ${latency}–º—Å`);
                return { success: true, latency };
            } catch (error) {
                updateTestCard('test1', 'error', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                log('error', '–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–æ–≤–æ–º—É URL', error);
                return { success: false, error: error.message };
            }
        }

        // –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ REST API
        async function testRestApi() {
            log('info', '–ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–∞ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ REST API');
            updateTestCard('test2', 'warning', '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');
            
            try {
                const url = `${config.supabaseUrl}/rest/v1/`;
                const response = await fetch(url, {
                    headers: {
                        'apikey': config.anonKey,
                        'Authorization': `Bearer ${config.anonKey}`
                    }
                });
                
                const data = await response.text();
                
                if (response.status === 200) {
                    updateTestCard('test2', 'success', `‚úÖ REST API –¥–æ—Å—Ç—É–ø–µ–Ω\nüìä –°—Ç–∞—Ç—É—Å: ${response.status}`);
                    log('success', 'REST API –¥–æ—Å—Ç—É–ø–µ–Ω', { status: response.status });
                    return { success: true, status: response.status };
                } else {
                    updateTestCard('test2', 'warning', `‚ö†Ô∏è REST API –æ—Ç–≤–µ—Ç–∏–ª —Å –∫–æ–¥–æ–º: ${response.status}\n${data.substring(0, 200)}...`);
                    log('warning', 'REST API –æ—Ç–≤–µ—Ç–∏–ª —Å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º', { 
                        status: response.status,
                        response: data 
                    });
                    return { success: false, status: response.status };
                }
            } catch (error) {
                updateTestCard('test2', 'error', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                log('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ REST API', error);
                return { success: false, error: error.message };
            }
        }

        // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        async function testAuth() {
            log('info', '–ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–∞ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏');
            updateTestCard('test3', 'warning', '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');
            
            try {
                const url = `${config.supabaseUrl}/auth/v1/`;
                const response = await fetch(url, {
                    headers: {
                        'apikey': config.anonKey,
                        'Authorization': `Bearer ${config.anonKey}`
                    }
                });
                
                if (response.status === 200 || response.status === 401) {
                    // 401 - –æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
                    const data = await response.text();
                    updateTestCard('test3', 'success', `‚úÖ Auth API –¥–æ—Å—Ç—É–ø–µ–Ω\nüìä –°—Ç–∞—Ç—É—Å: ${response.status}`);
                    log('success', 'Auth API –¥–æ—Å—Ç—É–ø–µ–Ω', { status: response.status });
                    return { success: true, status: response.status };
                } else {
                    updateTestCard('test3', 'warning', `‚ö†Ô∏è Auth API –æ—Ç–≤–µ—Ç–∏–ª —Å –∫–æ–¥–æ–º: ${response.status}`);
                    log('warning', 'Auth API –æ—Ç–≤–µ—Ç–∏–ª —Å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º', { status: response.status });
                    return { success: false, status: response.status };
                }
            } catch (error) {
                updateTestCard('test3', 'error', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                log('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ Auth API', error);
                return { success: false, error: error.message };
            }
        }

        // –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ Realtime
        async function testRealtime() {
            log('info', '–ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–∞ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ Realtime');
            updateTestCard('test4', 'warning', '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');
            
            return new Promise((resolve) => {
                const timeout = setTimeout(() => {
                    updateTestCard('test4', 'warning', '‚ö†Ô∏è WebSocket –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è HTTPS)');
                    log('warning', '–ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket –ø—Ä–æ–ø—É—â–µ–Ω–∞ –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä–∞');
                    resolve({ success: null, skipped: true });
                }, 2000);
                
                // –ü—ã—Ç–∞–µ–º—Å—è —Å–æ–∑–¥–∞—Ç—å WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                try {
                    const wsUrl = `wss://${config.supabaseUrl.replace('https://', '').replace('http://', '')}/realtime/v1/websocket`;
                    const socket = new WebSocket(wsUrl);
                    
                    socket.onopen = () => {
                        clearTimeout(timeout);
                        updateTestCard('test4', 'success', '‚úÖ Realtime WebSocket –¥–æ—Å—Ç—É–ø–µ–Ω');
                        log('success', 'Realtime WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                        socket.close();
                        resolve({ success: true });
                    };
                    
                    socket.onerror = (error) => {
                        clearTimeout(timeout);
                        updateTestCard('test4', 'error', '‚ùå –û—à–∏–±–∫–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è');
                        log('error', '–û—à–∏–±–∫–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è');
                        resolve({ success: false, error: 'WebSocket error' });
                    };
                } catch (error) {
                    clearTimeout(timeout);
                    updateTestCard('test4', 'warning', `‚ö†Ô∏è WebSocket –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${error.message}`);
                    log('warning', 'WebSocket –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', error);
                    resolve({ success: false, error: error.message });
                }
            });
        }

        // –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ Storage
        async function testStorage() {
            log('info', '–ó–∞–ø—É—Å–∫ –¢–µ—Å—Ç–∞ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ Storage');
            updateTestCard('test5', 'warning', '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...');
            
            try {
                const url = `${config.supabaseUrl}/storage/v1/bucket`;
                const response = await fetch(url, {
                    headers: {
                        'apikey': config.anonKey,
                        'Authorization': `Bearer ${config.anonKey}`
                    }
                });
                
                if (response.status === 200 || response.status === 401 || response.status === 403) {
                    // 401/403 - –æ–∂–∏–¥–∞–µ–º–æ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ –ø—Ä–∞–≤
                    updateTestCard('test5', 'success', `‚úÖ Storage API –¥–æ—Å—Ç—É–ø–µ–Ω\nüìä –°—Ç–∞—Ç—É—Å: ${response.status}`);
                    log('success', 'Storage API –¥–æ—Å—Ç—É–ø–µ–Ω', { status: response.status });
                    return { success: true, status: response.status };
                } else {
                    updateTestCard('test5', 'warning', `‚ö†Ô∏è Storage API –æ—Ç–≤–µ—Ç–∏–ª —Å –∫–æ–¥–æ–º: ${response.status}`);
                    log('warning', 'Storage API –æ—Ç–≤–µ—Ç–∏–ª —Å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º', { status: response.status });
                    return { success: false, status: response.status };
                }
            } catch (error) {
                updateTestCard('test5', 'error', `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                log('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ Storage API', error);
                return { success: false, error: error.message };
            }
        }

        // –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
        async function runAllTests() {
            // –°–±—Ä–æ—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            testResults = { passed: 0, failed: 0, total: 5 };
            logs = [];
            elements.logsContainer.innerHTML = '';
            elements.summary.innerHTML = '';
            
            // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏
            const loader = elements.runAllTests.querySelector('.loader');
            const buttonText = elements.runAllTests.querySelector('span:last-child');
            loader.classList.remove('hidden');
            buttonText.textContent = '–í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–µ—Å—Ç—ã...';
            elements.runAllTests.disabled = true;
            
            log('info', 'üöÄ –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase');
            
            // –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
            const tests = [
                { name: 'testBaseUrl', func: testBaseUrl },
                { name: 'testRestApi', func: testRestApi },
                { name: 'testAuth', func: testAuth },
                { name: 'testRealtime', func: testRealtime },
                { name: 'testStorage', func: testStorage }
            ];
            
            for (const test of tests) {
                const result = await test.func();
                if (result.success === true) {
                    testResults.passed++;
                } else if (result.success === false) {
                    testResults.failed++;
                }
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤
            const successRate = Math.round((testResults.passed / testResults.total) * 100);
            let summaryClass = 'summary';
            let summaryText = '';
            
            if (successRate === 100) {
                summaryClass += ' success';
                summaryText = `‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ! (${testResults.passed}/${testResults.total})`;
            } else if (successRate >= 60) {
                summaryClass += ' warning';
                summaryText = `‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —É—Å–ø–µ—à–Ω–æ: ${successRate}% (${testResults.passed}/${testResults.total})`;
            } else {
                summaryClass += ' error';
                summaryText = `‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º: ${successRate}% (${testResults.passed}/${testResults.total})`;
            }
            
            elements.summary.className = summaryClass;
            elements.summary.innerHTML = `
                <h3>–ò—Ç–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏</h3>
                <p>${summaryText}</p>
                <p>–£—Å–ø–µ—à–Ω–æ: ${testResults.passed} | –° –æ—à–∏–±–∫–∞–º–∏: ${testResults.failed} | –í—Å–µ–≥–æ: ${testResults.total}</p>
                <p>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: ${getRecommendations(successRate)}</p>
            `;
            
            log('info', `–ó–∞–≤–µ—Ä—à–µ–Ω—ã –≤—Å–µ —Ç–µ—Å—Ç—ã. –†–µ–∑—É–ª—å—Ç–∞—Ç: ${summaryText}`);
            
            // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏
            loader.classList.add('hidden');
            buttonText.textContent = '–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã';
            elements.runAllTests.disabled = false;
        }

        // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function getRecommendations(successRate) {
            if (successRate === 100) {
                return '–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ú–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É.';
            } else if (successRate >= 80) {
                return '–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –∏ –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞.';
            } else if (successRate >= 60) {
                return '–ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞ –≤ Supabase Dashboard.';
            } else {
                return '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL, –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.';
            }
        }

        // –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤
        function clearLogs() {
            logs = [];
            elements.logsContainer.innerHTML = '';
            log('info', '–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã');
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤
        function exportLogs() {
            const logData = {
                timestamp: new Date().toISOString(),
                config: {
                    url: config.supabaseUrl,
                    hasKey: config.publishableKey ? '–î–∞' : '–ù–µ—Ç'
                },
                results: testResults,
                logs: logs
            };
            
            const blob = new Blob([JSON.stringify(logData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `supabase-check-${new Date().toISOString().slice(0, 10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            log('info', '–õ–æ–≥–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ JSON —Ñ–∞–π–ª');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            elements.runAllTests.addEventListener('click', runAllTests);
            elements.clearLogs.addEventListener('click', clearLogs);
            elements.exportLogs.addEventListener('click', exportLogs);
            
            log('info', '–ü–∞–Ω–µ–ª—å –ø—Ä–æ–≤–µ—Ä–∫–∏ Supabase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
            log('info', `–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫: ${config.supabaseUrl}`);
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
